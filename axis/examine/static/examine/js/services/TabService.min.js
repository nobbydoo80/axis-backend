angular.module("axis.services.TabService").factory("TabService",function(a,e,t,n){function r(a){if(!a)throw new Error("Endpoint must be provided.");var e=a.split("."),t=(e[0],e[1]);return t}function i(){for(var a,e=t.get(),n=0;n<e.length;n++){var r=e[n];if(!r.abstract&&r.name.length>0)try{if(!b[r.name.split(".").pop()].disabled){a=r.name;break}}catch(a){}}return a||(a="index"),a}function d(a,e,t,n,i){var d=_.intersection(e.name.split("."),n.name.split("."));if(!d.length||-1!=d.indexOf("tabs")){var c=b[r(e.name)];angular.forEach(b,function(a,e){a.active=!1}),angular.isDefined(c)&&(c.active=!0)}}function c(a,i){var d=r(a);e.debug("endpoint",a,"current",t.current.name,"disabled",i),Object.keys(b).length||n.addState("tabs",u),b[d]={active:t.current.name==a,disabled:!!i},n.addState(a,{url:"/"+d,template:""})}function s(a,t){e.debug("tab",a,"is",t?"disabled":"enabled");var n=r(a);b[n].disabled=t}function o(e){try{if(b[r(e)].disabled)throw e+" is disabled";a.$broadcast("TabService.go",e),t.go(e,{},{location:l}),l=!0}catch(a){t.go(i())}}var b={},l="replace",u={abstract:!0,url:"/tabs"};return a.$on("$stateChangeStart",d),{go:o,addTab:c,tabs:b,updateDisableListener:s}});
