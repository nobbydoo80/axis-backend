!function(modules){function webpackJsonpCallback(data){for(var moduleId,chunkId,chunkIds=data[0],moreModules=data[1],executeModules=data[2],i=0,resolves=[];i<chunkIds.length;i++)chunkId=chunkIds[i],Object.prototype.hasOwnProperty.call(installedChunks,chunkId)&&installedChunks[chunkId]&&resolves.push(installedChunks[chunkId][0]),installedChunks[chunkId]=0;for(moduleId in moreModules)Object.prototype.hasOwnProperty.call(moreModules,moduleId)&&(modules[moduleId]=moreModules[moduleId]);for(parentJsonpFunction&&parentJsonpFunction(data);resolves.length;)resolves.shift()();return deferredModules.push.apply(deferredModules,executeModules||[]),checkDeferredModules()}function checkDeferredModules(){for(var result,i=0;i<deferredModules.length;i++){for(var deferredModule=deferredModules[i],fulfilled=!0,j=1;j<deferredModule.length;j++){var depId=deferredModule[j];0!==installedChunks[depId]&&(fulfilled=!1)}fulfilled&&(deferredModules.splice(i--,1),result=__webpack_require__(__webpack_require__.s=deferredModule[0]))}return result}var installedModules={},installedChunks={4:0},deferredModules=[];function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}__webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{enumerable:!0,get:getter})},__webpack_require__.r=function(exports){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(exports,"__esModule",{value:!0})},__webpack_require__.t=function(value,mode){if(1&mode&&(value=__webpack_require__(value)),8&mode)return value;if(4&mode&&"object"==typeof value&&value&&value.__esModule)return value;var ns=Object.create(null);if(__webpack_require__.r(ns),Object.defineProperty(ns,"default",{enumerable:!0,value:value}),2&mode&&"string"!=typeof value)for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="";var jsonpArray=window.webpackJsonp=window.webpackJsonp||[],oldJsonpFunction=jsonpArray.push.bind(jsonpArray);jsonpArray.push=webpackJsonpCallback,jsonpArray=jsonpArray.slice();for(var i=0;i<jsonpArray.length;i++)webpackJsonpCallback(jsonpArray[i]);var parentJsonpFunction=oldJsonpFunction;deferredModules.push([301,1]),checkDeferredModules()}({301:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var input_collection_api=__webpack_require__(77),ng_redux=__webpack_require__(47),lib=__webpack_require__(5),lib_default=__webpack_require__.n(lib);function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var collector=new(function(){function Collector(){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Collector),this.reset()}return function(Constructor,protoProps,staticProps){protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps)}(Collector,[{key:"reset",value:function(){this.collectors={},this.collector=null,this.api=null,this.instruments={}}},{key:"initialize",value:function(collectionInfo,keepPrevious){keepPrevious||this.reset();var specification=collectionInfo.specification,obj=Object(input_collection_api.DjangoInputCollection)(specification.meta.api);obj.full_specification=specification,obj.instruments=collectionInfo.instruments,this.collectors[specification.collection_request.id]=Object.assign({},obj),this.collectors[specification.eep_program_id]=Object.assign({},obj),1===this.collectors.length&&this.setCollector(id)}},{key:"setCollector",value:function(id){this.collector=this.collectors[id]||null,this.api=this.collector.api,this.instruments=this.collector.instruments}}]),Collector}()),STORE_OPEN_ANSWER="STORE_OPEN_ANSWER",REMOVE_OPEN_ANSWER="REMOVE_OPEN_ANSWER",RECEIVE_ANSWERS="RECEIVE_ANSWERS",RECEIVE_RELATED_ANSWERS="RECEIVE_RELATED_ANSWERS",DELETE_ANSWER="DELETE_ANSWER",UPDATE_COMMENT="UPDATE_COMMENT",STORE_DOCUMENT="STORE_DOCUMENT",STORE_DOCUMENTS_SHELL="STORE_DOCUMENTS_SHELL",REMOVE_DOCUMENT="REMOVE_DOCUMENT",REMOVE_DOCUMENT_SHELL="REMOVE_DOCUMENT_SHELL",ATTACH_DOCUMENT="ATTACH_DOCUMENT",SAVING_ANSWER="SAVING_ANSWER",ANSWER_SAVED="ANSWER_SAVED",constants_answers={STORE_MULTIPLE_CHOICE_ANSWER:"STORE_MULTIPLE_CHOICE_ANSWER",REMOVE_MULTIPLE_CHOICE_ANSWER:"REMOVE_MULTIPLE_CHOICE_ANSWER",STORE_OPEN_ANSWER:STORE_OPEN_ANSWER,REMOVE_OPEN_ANSWER:REMOVE_OPEN_ANSWER,RECEIVE_ANSWERS:RECEIVE_ANSWERS,RECEIVE_RELATED_ANSWERS:RECEIVE_RELATED_ANSWERS,DELETE_ANSWER:DELETE_ANSWER,UPDATE_COMMENT:UPDATE_COMMENT,STORE_DOCUMENT:STORE_DOCUMENT,STORE_DOCUMENTS_SHELL:STORE_DOCUMENTS_SHELL,REMOVE_DOCUMENT:REMOVE_DOCUMENT,REMOVE_DOCUMENT_SHELL:REMOVE_DOCUMENT_SHELL,ATTACH_DOCUMENT:ATTACH_DOCUMENT,SAVING_ANSWER:SAVING_ANSWER,ANSWER_SAVED:ANSWER_SAVED},SET_SETTING="SET_SETTING",constants_interactions={SET_INTERACTION_SETTING:"SET_INTERACTION_SETTING",SET_SHOW_INTERACTION_SETTINGS:"SET_SHOW_INTERACTION_SETTINGS",SET_SHOW_FILTER_SETTINGS:"SET_SHOW_FILTER_SETTINGS",SET_SETTING:SET_SETTING,CLIENT_ERROR:"CLIENT_ERROR",SERVER_ERROR:"SERVER_ERROR",REMOVE_ERROR:"REMOVE_ERROR"},REQUEST_QUESTIONS="REQUEST_QUESTIONS",RECEIVE_QUESTIONS="RECEIVE_QUESTIONS",constants_questions={REQUEST_QUESTIONS:REQUEST_QUESTIONS,RECEIVE_QUESTIONS:RECEIVE_QUESTIONS,SELECT_QUESTION:"SELECT_QUESTION",SET_FILTER_STRING:"SET_FILTER_STRING",SET_FILTER_CHECKBOX:"SET_FILTER_CHECKBOX"},constants_entities={RECEIVE_EEP_PROGRAM:"RECEIVE_EEP_PROGRAM",RECEIVE_CHECKLIST:"RECEIVE_CHECKLIST",DISCARD_PROGRAM:"DISCARD_PROGRAM",DISCARD_CHECKLISTS:"DISCARD_CHECKLISTS",DISCARD_QUESTIONS:"DISCARD_QUESTIONS",CLEAR_ENTITIES:"CLEAR_ENTITIES"};function ingest(dispatch){return function(info){collector.initialize(info,!0),dispatch(function(program){return{type:constants_entities.RECEIVE_EEP_PROGRAM,payload:{program:program}}}({id:info.specification.eep_program_id,name:info.specification.name,user_role:info.specification.user_role})),ingestInstruments(dispatch)(info.instruments,info.specification.user_role)}}function ingestInstruments(dispatch){return function(instruments,user_role){void 0!==instruments.json&&(instruments=instruments.json),dispatch(function(questions){return{type:RECEIVE_QUESTIONS,payload:{questions:questions}}}(_.indexBy(instruments,"measure"))),_.each(instruments,function(instrument){instrument.user_role=user_role,collector.setCollector(instrument.collection_request);var read_only=collector.collector.full_specification.read_only;read_only&&(instrument.read_only=read_only),_.each(instrument.collectedinput_set,function(inputList,role){_.each(inputList,function(input){input.measure=instrument.measure}),role==instrument.user_role?dispatch(function(answers){return{type:RECEIVE_ANSWERS,payload:{answers:answers}}}(inputList)):dispatch(function(answers){return{type:RECEIVE_RELATED_ANSWERS,payload:{answers:answers}}}(inputList))})})}}function entitiesActions($http){return{discoverCollectors:function(discoverId){return function(dispatch,getState){dispatch({type:REQUEST_QUESTIONS});var homeId=getState().settings.homeId,queryParams={};return void 0!==discoverId&&(queryParams.collection_request_id=discoverId),$http.get("/api/v2/home/".concat(homeId,"/collectors/"),queryParams).success(function(collections){return _.map(collections,ingest(dispatch))})}},addInstruments:function(instrumentsList,userRole,dispatch){return ingestInstruments(dispatch)(instrumentsList,userRole)}}}var es=__webpack_require__(3);function _toConsumableArray(arr){return function(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var visibleQuestionsSelector=es.a.apply(void 0,[function(state){return state.entities.questions},function(state){return state.entities.sections},function(state){return state.entities.eepPrograms},function(state){return state.entities.checklists},function(state){return state.filters},function(state){return state.settings.display.splitQuestionsByProgram},function(state){return state.router.currentParams.id}].concat([function(){var questions=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},programs=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},filters=4<arguments.length&&void 0!==arguments[4]?arguments[4]:{},splitByProgram=5<arguments.length&&void 0!==arguments[5]&&arguments[5],currentQuestionId=6<arguments.length&&void 0!==arguments[6]?arguments[6]:null,filterStates=(filters.types,filters.states),filterPrograms=(filters.sections,filters.programs),instruments=questions,filter=function(types,states,programs,currentQuestionId){return function(question){if(void 0===question.collection_request)return!1;if(question.id==currentQuestionId)return!0;var activeRole=((collector.collectors[question.collection_request]||{}).full_specification||{}).user_role,answer=(question.collectedinput_set[activeRole]||[])[0]||{};return!!question.is_condition_met&&(!(!states.required&&question.response_policy.required)&&(!(!states.optional&&!question.response_policy.required)&&(!(!states.answered&&answer.id)&&(!(!states.unanswered&&!answer.id)&&(!programs.length||-1!=programs.indexOf(question.measure))))))}}(0,filterStates,filterPrograms=function(programs,filterPrograms){var _ref,activeProgramIds=Object.keys(filterPrograms).filter(function(k){return filterPrograms[k]});return(_ref=[]).concat.apply(_ref,_toConsumableArray(_.map(activeProgramIds,function(id){return _.pluck(collector.collectors[id].instruments,"measure")})))}(0,filterPrograms),currentQuestionId),filteredQuestions=_.filter(instruments,filter).sort(function(a,b){return a.order-b.order}).sort(function(a,b){return a.collection_request-b.collection_request});return Object.keys(programs).length&&splitByProgram?function(questions,programs){var byProgram={};return _.each(programs,function(program){var questionList=[];_.each(questions,function(question){question.eep_program_id==program.id&&questionList.push(question)}),questionList.length&&(byProgram[program.collection_request]=questionList)}),byProgram}(filteredQuestions,programs):filteredQuestions}])),visibleQuestionIdsSelector=Object(es.a)(visibleQuestionsSelector,function(visibleQuestions){return _.pluck(visibleQuestions,"measure")});var currentQuestion=es.a.apply(void 0,[function(state){return state.router.currentParams.id},function(state){return state.entities.questions}].concat([function(id,questions){return questions[id]}]));var previousQuestionId=es.a.apply(void 0,[visibleQuestionIdsSelector,function(state){return state.router.currentParams.id}].concat([function(measures,currentMeasure){var currentIndex=measures.indexOf(currentMeasure);return 0!==currentIndex&&measures[currentIndex-1]}])),nextQuestionId=es.a.apply(void 0,[visibleQuestionIdsSelector,function(state){return state.router.currentParams.id}].concat([function(measures,currentMeasure){var currentIndex=measures.indexOf(currentMeasure);return currentIndex!==measures.length-1&&measures[currentIndex+1]}]));function setSetting(key,value){return{type:SET_SETTING,payload:{key:key,value:value}}}function saveToLocalStorage(fn){return function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return function(dispatch,getState){dispatch(fn.apply(void 0,args)),localStorage.setItem("checklist:filter_settings",JSON.stringify(getState().filters))}}}function updateComment(comment,questionId){return{type:UPDATE_COMMENT,payload:{comment:comment,questionId:questionId}}}function removeDocument(fileName,questionId){return{type:REMOVE_DOCUMENT,payload:{fileName:fileName,questionId:questionId}}}function clientError(error,questionId){return{type:constants_interactions.CLIENT_ERROR,payload:{questionId:questionId,errors:[error.message]}}}function serverError(errors,questionId){return{type:constants_interactions.SERVER_ERROR,payload:{questionId:questionId,errors:errors}}}function remove(questionId){return{type:REMOVE_OPEN_ANSWER,payload:{questionId:questionId}}}var filters={SET_FILTER_STRING:"SET_FILTER_STRING",SET_TYPE_CHECKBOX:"SET_TYPE_CHECKBOX",SET_STATE_CHECKBOX:"SET_STATE_CHECKBOX",SET_SECTION_CHECKBOX:"SET_SECTION_CHECKBOX",SET_PROGRAM_CHECKBOX:"SET_PROGRAM_CHECKBOX",RESET_FILTERS:"RESET_FILTERS"};function filters_setSearchString(value){return{type:filters.SET_FILTER_STRING,payload:{value:value}}}function setTypeCheckbox(key,value){return{type:filters.SET_TYPE_CHECKBOX,payload:{key:key,value:value}}}function setStateCheckbox(key,value){return{type:filters.SET_STATE_CHECKBOX,payload:{key:key,value:value}}}function setSectionCheckbox(key,value){return{type:filters.SET_SECTION_CHECKBOX,payload:{key:key,value:value}}}function setProgramCheckbox(key,value){return{type:filters.SET_PROGRAM_CHECKBOX,payload:{key:key,value:value}}}function resetFilters(){return{type:filters.RESET_FILTERS}}function checklistActions_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var checklistActions_ChecklistActionsController=function(){function ChecklistActionsController($ngRedux,$scope){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ChecklistActionsController),$scope.$on("$destroy",$ngRedux.connect(this.mapStateToThis.bind(this))(this))}return function(Constructor,protoProps,staticProps){protoProps&&checklistActions_defineProperties(Constructor.prototype,protoProps),staticProps&&checklistActions_defineProperties(Constructor,staticProps)}(ChecklistActionsController,[{key:"saveDisabled",value:function(){return this.isSaveDisabled||this.isSaving}},{key:"mapStateToThis",value:function(state){return{previousDisabled:!1===previousQuestionId(state),nextDisabled:!1===nextQuestionId(state)}}}]),ChecklistActionsController}();var READONLY=window.readonly,QuestionFilters={searchString:"",types:{open:{label:"Open",active:!0},"multiple-choice":{label:"Multiple Choice",active:!0},date:{label:"Date",active:!0},datetime:{label:"Date Time",active:!0},integer:{label:"Whole Number",active:!0},float:{label:"Decimal Number",active:!0},csv:{label:"Comma Separated Value",active:!0},kvfloatcsv:{label:"Key Value Comma Separated Value",active:!0}},states:{required:{label:"Required",active:!0},optional:{label:"Optional",active:!1},answered:{label:"Answered",active:!1},unanswered:{label:"Unanswered",active:!0}},sections:{},programs:{}},QuestionTypeLabels=_.mapValues(QuestionFilters.types,"label"),QuestionStateLabels=_.mapValues(QuestionFilters.states,"label"),INTERACTIONS={autoSubmitMultipleChoice:{active:!0,label:"Submit Multiple Choice Answer when selected"},submitOpenOnEnter:{active:!0,label:"Submit Open field answers on Enter"},autoAdvanceOnAnswer:{active:!0,label:"Advance to next question on Answer"},skipAnsweredQuestions:{active:!0,label:"Skip Questions that already have answers"}},INTERACTION_VALUES=_.mapValues(INTERACTIONS,"active"),INTERACTION_LABELS=_.mapValues(INTERACTIONS,"label"),INTERACTION_ORDER=["autoSubmitMultipleChoice","submitOpenOnEnter","autoAdvanceOnAnswer","skipAnsweredQuestions"],DISPLAY={qaListColoringEnabled:{active:!0,label:"Color questions in the list to show QA status",canShow:function(state){return _.filter(state.entities.eepPrograms,{user_role:"qa"})}},showRelatedAnswers:{active:!0,label:"Show related Answers inline when viewing a question",canShow:function(state){return _.filter(state.entities.eepPrograms,{user_role:"qa"})}},splitQuestionsByProgram:{active:!1,label:"Split questions by the Program they belong to",canShow:function(state){return 1<Object.keys(state.entities.eepPrograms).length}},showRelatedAnswerInQuestionList:{active:!1,label:"Show Related Answer in Question List (default: QA Answer)",canShow:function(state){return _.filter(state.entities.eepPrograms,{user_role:"qa"}).length}}},DISPLAY_VALUES=_.mapValues(DISPLAY,"active"),DISPLAY_LABELS=_.mapValues(DISPLAY,"label"),DISPLAY_CAN_SHOW=_.mapValues(DISPLAY,"canShow"),DISPLAY_ORDER=["qaListColoringEnabled","showRelatedAnswers","splitQuestionsByProgram","showRelatedAnswerInQuestionList"],PLACEHOLDERS={open:"Enter Answer",date:"Enter a date",integer:"Enter a Whole Number",float:"Enter a decimal",csv:"Enter Answer",kvfloatcsv:"Enter Answer",text:"Enter Answer",hidden:""},TOOLTIPS={open:"Enter Answer",date:"Enter a date",integer:"Enter a Whole Number",float:"Enter a decimal",csv:"Enter Answer",kvfloatcsv:"Enter Answer",text:"Enter Answer",hidden:""};function collectionApp_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var CollectionAppController=function(){function CollectionAppController($http,$ngRedux,QuestionActions,InteractionActions,EntitiesActions){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,CollectionAppController),this.$http=$http,this.dispatch=$ngRedux.dispatch,this.getState=$ngRedux.getState,this.QuestionActions=QuestionActions,this.InteractionActions=InteractionActions,this.EntitiesActions=EntitiesActions,this.initSettings(),this.initData()}return function(Constructor,protoProps,staticProps){protoProps&&collectionApp_defineProperties(Constructor.prototype,protoProps),staticProps&&collectionApp_defineProperties(Constructor,staticProps)}(CollectionAppController,[{key:"initSettings",value:function(){this.dispatch(this.InteractionActions.setSetting("homeId",this.homeId)),this.dispatch(this.InteractionActions.setSetting("debug",window.allow_debug))}},{key:"initData",value:function(){this.homeId&&this.dispatch(this.EntitiesActions.discoverCollectors())}}]),CollectionAppController}();function getCleanedObject(valuesObj,labelsObj){return function(key){return{key:key,name:labelsObj[key],selected:valuesObj[key]}}}var questionFilters=es.a.apply(void 0,[function(state){return state.filters.types},function(state){return state.filters.states},function(state){return state.filters.sections},function(state){return state.entities.sections},function(state){return state.filters.programs},function(state){return state.entities.eepPrograms}].concat([function(types,states,filterSections,entitiesSections,filterPrograms,entitiesPrograms){return{types:Object.keys(types).map(getCleanedObject(types,QuestionTypeLabels)),states:Object.keys(states).map(getCleanedObject(states,QuestionStateLabels)),sections:Object.keys(entitiesSections).map(getCleanedObject(filterSections,_.mapValues(entitiesSections,"name"))),programs:Object.keys(entitiesPrograms).map(getCleanedObject(filterPrograms,_.mapValues(entitiesPrograms,"name")))}}]));function filterSettings_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function filterSettings_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function filterSettings_createClass(Constructor,protoProps,staticProps){return protoProps&&filterSettings_defineProperties(Constructor.prototype,protoProps),staticProps&&filterSettings_defineProperties(Constructor,staticProps),Constructor}var FilterSettingsController=function(){function FilterSettingsController($ngRedux,FilterActions){filterSettings_classCallCheck(this,FilterSettingsController),this.dispatch=$ngRedux.dispatch,this.FilterActions=FilterActions,this.showing=!0}return filterSettings_createClass(FilterSettingsController,[{key:"resetFilters",value:function(e){e.preventDefault(),this.dispatch(this.FilterActions.resetFilters())}}]),FilterSettingsController}();var filterSettings_SingleFilterController=function(){function SingleFilterController($ngRedux,$scope,FilterActions){filterSettings_classCallCheck(this,SingleFilterController),this.dispatch=$ngRedux.dispatch,this.FilterActions=FilterActions,this.toggleBox=this.createToggleAction(this.getFilterAction(this.lookup)),$scope.$on("$destroy",$ngRedux.connect(questionFilters)(this))}return filterSettings_createClass(SingleFilterController,[{key:"createToggleAction",value:function(action){return function(data){if(data){var key=data.key,selected=data.selected;this.dispatch(action(key,selected))}}}},{key:"getFilterAction",value:function(key){return{types:this.FilterActions.setTypeCheckbox,states:this.FilterActions.setStateCheckbox,sections:this.FilterActions.setSectionCheckbox,programs:this.FilterActions.setProgramCheckbox}[key]}}]),SingleFilterController}();function userSettings_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var userSettings_UserSettingsController=function(){function UserSettingsController($ngRedux,$scope,InteractionActions){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,UserSettingsController),this.dispatch=$ngRedux.dispatch,this.labels=_.assign({},INTERACTION_LABELS,DISPLAY_LABELS),this.InteractionActions=InteractionActions,this.interactionOrder=INTERACTION_ORDER,this.displayOrder=DISPLAY_ORDER,$scope.$on("$destroy",$ngRedux.connect(this.mapStateToThis.bind(this))(this))}return function(Constructor,protoProps,staticProps){protoProps&&userSettings_defineProperties(Constructor.prototype,protoProps),staticProps&&userSettings_defineProperties(Constructor,staticProps)}(UserSettingsController,[{key:"mapStateToThis",value:function(state){var _state$settings=state.settings,interactions=_state$settings.interactions,display=_state$settings.display;return{interactions:interactions,display:display=_.omit(display,function(value,key){return!DISPLAY_CAN_SHOW[key](state)}),showDisplay:!!Object.keys(display).length}}},{key:"toggleSetting",value:function(key,value){this.dispatch(this.InteractionActions.setInteractionSetting(key,!value))}}]),UserSettingsController}();var questionListClasses_inputSelectors=[visibleQuestionsSelector,function(state){return state.entities.answers},function(state){return state.entities.relatedAnswers},function(state){return state.settings.display.qaListColoringEnabled}];var questionListClasses=es.a.apply(void 0,questionListClasses_inputSelectors.concat([function(questions,answers,relatedAnswers,coloringEnabled){var questionColors={},callback=function(answers,relatedAnswers,coloringEnabled,result){return function(item){var klasses=[],roleAnswer=answers[item.measure]||{},relatedAnswer=relatedAnswers[item.measure]||{};item.read_only?klasses.push("disabled pointer-cursor"):coloringEnabled&&relatedAnswer.id?roleAnswer.id?roleAnswer.data.input===relatedAnswer.data.input?klasses.push("list-group-item-success"):klasses.push("list-group-item-danger"):klasses.push("list-group-item-info"):roleAnswer.id&&klasses.push("disabled pointer-cursor"),result[item.id]=klasses.join(" ")}}(answers,relatedAnswers,coloringEnabled,questionColors);return _.isPlainObject(questions)&&(questions=_.union.apply(null,_.values(questions))),questions.map(callback),questionColors}]));function _slicedToArray(arr,i){return function(arr){if(Array.isArray(arr))return arr}(arr)||function(arr,i){var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var questionsStatistics=es.a.apply(void 0,[function(state){return state.entities.questions},function(state){return state.entities.answers}].concat([function(questions,answers){var activeQuestions=_.filter(questions,function(question){return question.is_condition_met}),totalQuestions=Object.keys(activeQuestions).length,_$partition2=_slicedToArray(_.partition(activeQuestions,function(question){return question.response_policy.required}),2),required=_$partition2[0],optional=_$partition2[1],totalRequired=required.length,totalOptional=optional.length,remainingRequired=required.filter(function(q){return!answers[q.measure]}).length,remainingOptional=optional.filter(function(q){return!answers[q.measure]}).length;return{totalQuestions:totalQuestions,totalRequiredQuestions:totalRequired,totalOptionalQuestions:totalOptional,answeredRequiredQuestions:totalRequired-remainingRequired,answeredOptionalQuestions:totalOptional-remainingOptional,remainingRequiredQuestions:remainingRequired,remainingOptionalQuestions:remainingOptional}}]));function questionList_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function questionList_toConsumableArray(arr){return function(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var listControllerState=es.a.apply(void 0,[function(state){return state.entities},function(state){return state.settings},function(state){return state.filters.searchString}].concat([function(entities,settings,searchString){var answers=entities.answers,relatedAnswers=entities.relatedAnswers,temporaryAnswer=entities.temporaryAnswer,errors=entities.errors,eepPrograms=entities.eepPrograms,fetchingQuestions=settings.fetchingQuestions,debug=settings.debug,splitQuestionsByProgram=settings.display.splitQuestionsByProgram;return{answers:answers,relatedAnswers:relatedAnswers,temporaryAnswer:temporaryAnswer,errors:errors,debug:debug,searchString:searchString,eepPrograms:eepPrograms,splitQuestionsByProgram:splitQuestionsByProgram=splitQuestionsByProgram&&1<Object.keys(eepPrograms).length,coloringEnabled:settings.display.qaListColoringEnabled,isFetching:fetchingQuestions}}])),visibleQuestionsCount=Object(es.a)(visibleQuestionsSelector,function(questions){var _ref;return _.isPlainObject(questions)?(_ref=[]).concat.apply(_ref,questionList_toConsumableArray(_.values(questions))).length:questions.length});var answerDisplaySelector=es.a.apply(void 0,[function(state){return state.entities.questions},function(state){return state.entities.answers},function(state){return state.entities.relatedAnswers},function(state){return state.settings.display.showRelatedAnswerInQuestionList}].concat([function(){var questions=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},roleAnswers=3<arguments.length&&void 0!==arguments[3]&&arguments[3]?2<arguments.length&&void 0!==arguments[2]?arguments[2]:{}:1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},answerIdsToKeep=Object.keys(_.indexBy(questions,"measure")),answersToKeep=_.pick(roleAnswers,answerIdsToKeep);return _.indexBy(answersToKeep,"measure")}])),questionList_QuestionListController=function(){function QuestionListController($ngRedux,$scope,$interpolate){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,QuestionListController),this.getState=$ngRedux.getState,this.$interpolate=$interpolate;$scope.$on("$destroy",$ngRedux.connect(function(state){return{questions:visibleQuestionsSelector(state)}})(this)),$scope.$on("$destroy",$ngRedux.connect(listControllerState)(this)),$scope.$on("$destroy",$ngRedux.connect(function(state){return{questionColors:questionListClasses(state)}})(this)),$scope.$on("$destroy",$ngRedux.connect(questionsStatistics)(this)),$scope.$on("$destroy",$ngRedux.connect(function(state){return{questionCount:visibleQuestionsCount(state)}})(this)),$scope.$on("$destroy",$ngRedux.connect(function(state){return{answerDisplay:answerDisplaySelector(state)}})(this)),this.getAnswerPreview=function(measure){var instrument=$ngRedux.getState().entities.questions[measure],answers=this.answers,showRelatedAnswerInQuestionList=this.getState().settings.display.showRelatedAnswerInQuestionList,numPrograms=_.keys(this.getState().entities.eepPrograms).length,raterIsSoleProgram=0<_.filter(this.getState().entities.eepPrograms,function(programPicker){return-1===programPicker.name.indexOf("QA")}).length;(showRelatedAnswerInQuestionList||1==numPrograms&&raterIsSoleProgram)&&"rater"!=instrument.user_role&&(answers=this.relatedAnswers);var answer=answers[measure];if(void 0===answer)return null;var displayFormat=collector.collectors[instrument.collection_request].full_specification.instruments_info.instruments[instrument.id].response_info.method.display_format_short||"[[ input ]]",data=answer.data;return angular.isObject(data.input)&&(data=data.input),this.format(displayFormat,data)}}return function(Constructor,protoProps,staticProps){protoProps&&questionList_defineProperties(Constructor.prototype,protoProps),staticProps&&questionList_defineProperties(Constructor,staticProps)}(QuestionListController,[{key:"format",value:function(spec,data){return spec=spec.replace(/\{/g,"[[ ").replace(/\}/g," ]]"),this.$interpolate(spec)(data)}}]),QuestionListController}();function questionDetail_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var questionDetail_QuestionDetailController=function(){function QuestionDetailController($ngRedux,$scope,$sce,AnswerActions,InteractionActions){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,QuestionDetailController),this.getState=$ngRedux.getState,this.dispatch=$ngRedux.dispatch,this.trustAsHtml=$sce.trustAsHtml,this.AnswerActions=AnswerActions,this.InteractionActions=InteractionActions,this.initNavigation(),this.hooks={update:this.update.bind(this)},$scope.$on("$destroy",$ngRedux.connect(this.mapStateToThis.bind(this))(this))}return function(Constructor,protoProps,staticProps){protoProps&&questionDetail_defineProperties(Constructor.prototype,protoProps),staticProps&&questionDetail_defineProperties(Constructor,staticProps)}(QuestionDetailController,[{key:"mapStateToThis",value:function(state){var _state$entities=state.entities,questions=_state$entities.questions,errors=_state$entities.errors,_state$settings=state.settings,isSaving=_state$settings.savingAnswer,interactionSettings=_state$settings.interactions,display=_state$settings.display,debug=_state$settings.debug,measure=state.router.currentParams.id,question=questions[measure]||{};if(void 0===question.collection_request)return{};var answer=function(measure){var answer=state.entities.answers[measure],tempAnswer=state.entities.temporaryAnswer[measure];return answer||tempAnswer||{data:{input:null,comment:null},customer_documents:[]}}(measure),activeRole=collector.collectors[question.collection_request].full_specification.user_role,documentTypeRequired=answer.selectedChoice&&(answer.selectedChoice.image_required||answer.selectedChoice.document_required),isValid=answer.data&&answer.data.input&&(!answer.selectedChoice||!answer.selectedChoice.comment_required||!!answer.data.comment)&&(!documentTypeRequired||answer.customer_documents.length),isDisabled=!0===question.read_only||question.user_role!=activeRole||void 0!==answer.id||answer.user_role&&answer.user_role!=question.user_role,saveDisabled=isDisabled||!isValid,canRetract=void 0!==answer.id&&(!1===answer.is_failure||!0===answer.failure_is_reviewed)&&!1===question.read_only;return{activeRole:activeRole,question:question,answer:answer,relatedAnswer:state.entities.relatedAnswers[measure],errors:errors[measure],showRelatedAnswers:display.showRelatedAnswers,interactionSettings:interactionSettings,isValid:isValid,isDisabled:isDisabled,saveDisabled:saveDisabled,isSaving:isSaving,canRetract:canRetract,debug:debug}}},{key:"initNavigation",value:function(){var _this=this;this.next=function(){return _this.dispatch(_this.InteractionActions.gotoNextQuestion(_this.question.measure))},this.previous=function(){return _this.dispatch(_this.InteractionActions.gotoPreviousQuestion(_this.question.measure))}}},{key:"clear",value:function(){this.dispatch(this.AnswerActions.clear(this.question.measure))}},{key:"update",value:function(argument_0,argument_1){var save=0<arguments.length&&void 0!==argument_0&&argument_0,selectedChoice=1<arguments.length&&void 0!==argument_1?argument_1:void 0;this.dispatch(this.AnswerActions.stage(this.question,this.answer.data,selectedChoice)),save&&this.save()}},{key:"save",value:function(){this.dispatch(this.AnswerActions.save(this.question,this.answer.data,this.answer.customer_documents))}},{key:"retract",value:function(){this.dispatch(this.AnswerActions.retract(this.question.measure))}},{key:"documentCallback",value:function(name,file,extension){this.dispatch(this.AnswerActions.storeDocument({name:name,file:file,extension:extension},this.question.measure))}},{key:"removeDocument",value:function(doc){this.dispatch(this.AnswerActions.removeDocument(doc.name,this.question.measure))}}]),QuestionDetailController}();var redux_thunk_es=__webpack_require__(48),redux_logger=__webpack_require__(49),isHomePage="home"===window.__ExamineSettings.page,checklistList={url:"/",parent:isHomePage?"tabs.checklist":null,views:{detail:{template:isHomePage?'\n    <h4 class="text-center">Please select a question.</h4>\n':'\n    <span ng-controller="ExamineViewController as examineApp">\n        <axis-single-region options="pageRegions.home"></axis-single-region>\n    </span>\n'}}},checklistDetail={url:"question/:id",views:{"detail@":{template:" <question-detail></question-detail> "}}},settings={url:"settings",views:{"detail@":{template:'\n                <div class="row">\n                    <div class="col-xs-12">\n                        <user-settings></user-settings>\n                    </div>\n                </div>\n            '}}},redux=__webpack_require__(7),sections={REQUEST_SECTIONS:"REQUEST_SECTIONS",RECEIVE_SECTIONS:"RECEIVE_SECTIONS"};function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var typeDefaults=_.mapValues(QuestionFilters.types,function(n){return n.active}),stateDefaults=_.mapValues(QuestionFilters.states,function(n){return n.active}),defaultState=_.assign({},QuestionFilters,{types:typeDefaults,states:stateDefaults}),defaultStateWithLocalStorage=_.assign({},defaultState,JSON.parse(localStorage.getItem("checklist:filter_settings"))||{});function settings_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var settings_defaultState={showInteractionSettings:!1,showFilterSettings:!1,questionOrder:[],interactions:_.assign({},INTERACTION_VALUES,JSON.parse(localStorage.getItem("checklist:interaction_settings"))||{}),display:_.assign({},DISPLAY_VALUES,JSON.parse(localStorage.getItem("checklist:display_settings"))||{}),baseUrl:"",homeId:0,eepProgramIds:[],readonly:!0,savingAnswer:!1,fetchingQuestions:!1};function entities_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _extendByKey(currentState,object,argument_2){var key=2<arguments.length&&void 0!==argument_2?argument_2:"id";return _.assign({},currentState,entities_defineProperty({},object[key],object))}var reducers_entities=Object(redux.combineReducers)({questions:function(){var state=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},action=1<arguments.length?arguments[1]:void 0;switch(action.type){case constants_entities.CLEAR_ENTITIES:return{};case constants_questions.RECEIVE_QUESTIONS:return _.assign({},state,action.payload.questions);case constants_entities.DISCARD_QUESTIONS:return _.omit(state,action.payload.questionIds);default:return state}},answers:function(){var state=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},action=1<arguments.length?arguments[1]:void 0;switch(action.type){case constants_entities.CLEAR_ENTITIES:return{};case constants_answers.RECEIVE_ANSWERS:return _.assign({},state,_.indexBy(action.payload.answers,"measure"));case constants_answers.DELETE_ANSWER:return _.omit(state,action.payload.answerId);case constants_answers.ATTACH_DOCUMENT:var newDocuments=state[action.payload.answerId].customer_documents.concat([action.payload.document]),answer=state[action.payload.answerId],newAnswer=_.assign({},answer,{customer_documents:newDocuments});return _.assign({},state,entities_defineProperty({},action.payload.answerId,newAnswer));default:return state}},sections:function(){var state=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},action=1<arguments.length?arguments[1]:void 0;switch(action.type){case constants_entities.CLEAR_ENTITIES:return{};case sections.RECEIVE_SECTIONS:return _.assign({},state,_.indexBy(action.payload.sections,"id"));default:return state}},temporaryAnswer:function(){var state=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},action=1<arguments.length?arguments[1]:void 0,answer=null,customer_documents=null;switch(action.type){case constants_entities.CLEAR_ENTITIES:return{};case constants_answers.STORE_MULTIPLE_CHOICE_ANSWER:case constants_answers.STORE_OPEN_ANSWER:case constants_answers.UPDATE_COMMENT:case constants_answers.STORE_DOCUMENT:return customer_documents=(answer=state[action.payload.questionId]||{}).customer_documents||[],action.payload.file&&customer_documents.push(action.payload.file),_.assign({},state,entities_defineProperty({},action.payload.questionId,{data:action.payload.answer||answer.data||{input:null,comment:null},customer_documents:customer_documents,selectedChoice:action.payload.suggestedResponse}));case constants_answers.REMOVE_DOCUMENT:return customer_documents=(answer=state[action.payload.questionId]||{}).customer_documents||[],_.assign({},state,entities_defineProperty({},action.payload.questionId,{data:answer.data,customer_documents:_.filter(answer.customer_documents,function(file){return file.name!=action.payload.fileName})}));case constants_answers.REMOVE_MULTIPLE_CHOICE_ANSWER:case constants_answers.REMOVE_OPEN_ANSWER:return _.omit(state,action.payload.questionId);default:return state}},errors:function(){var state=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},action=1<arguments.length?arguments[1]:void 0;switch(action.type){case constants_entities.CLEAR_ENTITIES:return{};case constants_interactions.CLIENT_ERROR:case constants_interactions.SERVER_ERROR:return _.assign({},state,entities_defineProperty({},action.payload.questionId,action.payload.errors));case constants_interactions.REMOVE_ERROR:return _.omit(state,action.payload.questionId);default:return state}},relatedAnswers:function(){var state=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},action=1<arguments.length?arguments[1]:void 0;switch(action.type){case constants_entities.CLEAR_ENTITIES:return{};case constants_answers.RECEIVE_RELATED_ANSWERS:return _.assign({},state,_.indexBy(action.payload.answers,"measure"));default:return state}},eepPrograms:function(){var state=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},action=1<arguments.length?arguments[1]:void 0;switch(action.type){case constants_entities.CLEAR_ENTITIES:return{};case constants_entities.RECEIVE_EEP_PROGRAM:return _extendByKey(state,action.payload.program);case constants_entities.DISCARD_PROGRAM:return _.omit(state,action.payload.programId);default:return state}},checklists:function(){var state=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},action=1<arguments.length?arguments[1]:void 0;switch(action.type){case constants_entities.CLEAR_ENTITIES:return{};case constants_entities.RECEIVE_CHECKLIST:return _extendByKey(state,action.payload.checklist);case constants_entities.DISCARD_CHECKLISTS:return _.omit(state,action.payload.checklistIds);default:return state}}}),redux_rootReducer=Object(redux.combineReducers)({router:lib.router,filters:function(){var state=0<arguments.length&&void 0!==arguments[0]?arguments[0]:defaultStateWithLocalStorage,action=1<arguments.length?arguments[1]:void 0;switch(action.type){case filters.RESET_FILTERS:var resetSections=_.mapValues(state.sections,function(){return!1});return _.assign({},defaultState,{sections:resetSections});case filters.SET_FILTER_STRING:return _.assign({},state,{searchString:action.payload.value});case filters.SET_TYPE_CHECKBOX:var newTypes=_.assign({},state.types,_defineProperty({},action.payload.key,action.payload.value));return _.assign({},state,{types:newTypes});case filters.SET_STATE_CHECKBOX:var newStates=_.assign({},state.states,_defineProperty({},action.payload.key,action.payload.value));return _.assign({},state,{states:newStates});case sections.RECEIVE_SECTIONS:var sectionIds=_.pluck(action.payload.sections,"id"),temp={};sectionIds.map(function(id){return temp[id]=!1});var newSections=_.assign({},state.sections,temp);return _.assign({},state,{sections:newSections});case filters.SET_SECTION_CHECKBOX:newSections=_.assign({},state.sections,_defineProperty({},action.payload.key,action.payload.value));return _.assign({},state,{sections:newSections});case constants_entities.RECEIVE_EEP_PROGRAM:var program=action.payload.program,newPrograms=_.assign({},state.programs,_defineProperty({},program.id,!1));return _.assign({},state,{programs:newPrograms});case filters.SET_PROGRAM_CHECKBOX:newPrograms=_.assign({},state.programs,_defineProperty({},action.payload.key,action.payload.value));return _.assign({},state,{programs:newPrograms});default:return state}},settings:function(){var state=0<arguments.length&&void 0!==arguments[0]?arguments[0]:settings_defaultState,action=1<arguments.length?arguments[1]:void 0;switch(action.type){case constants_interactions.SET_INTERACTION_SETTING:if(action.payload.key in state.interactions)var update={interactions:_.assign({},state.interactions,settings_defineProperty({},action.payload.key,action.payload.value))};else if(action.payload.key in state.display)update={display:_.assign({},state.display,settings_defineProperty({},action.payload.key,action.payload.value))};return _.assign({},state,update);case constants_interactions.SET_SETTING:return _.assign({},state,settings_defineProperty({},action.payload.key,action.payload.value));case constants_answers.SAVING_ANSWER:return _.assign({},state,{savingAnswer:!0});case constants_answers.ANSWER_SAVED:return _.assign({},state,{savingAnswer:!1});case constants_questions.REQUEST_QUESTIONS:return _.assign({},state,{fetchingQuestions:!0});case constants_questions.RECEIVE_QUESTIONS:return _.assign({},state,{fetchingQuestions:!1});case constants_entities.CLEAR_ENTITIES:return _.assign({},state,{eepProgramIds:[]});default:return state}},entities:reducers_entities}),configs_isHomePage="home"===window.__ExamineSettings.page;function commentField_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var CommentFieldInputController=function(){function CommentFieldInputController($ngRedux,$scope){var _this=this;!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,CommentFieldInputController),this.displaySetter=function(){return _this.comment=_this.getDisplay($ngRedux.getState())},$scope.$on("$destroy",$scope.$watch(function(){return _this.answer},function(){return _this.displaySetter()}))}return function(Constructor,protoProps,staticProps){protoProps&&commentField_defineProperties(Constructor.prototype,protoProps),staticProps&&commentField_defineProperties(Constructor,staticProps)}(CommentFieldInputController,[{key:"getDisplay",value:function(state){return this.data}}]),CommentFieldInputController}();function multipleChoiceField_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function multipleChoiceField_toConsumableArray(arr){return function(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function multipleChoiceField_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function multipleChoiceField_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function multipleChoiceField_createClass(Constructor,protoProps,staticProps){return protoProps&&multipleChoiceField_defineProperties(Constructor.prototype,protoProps),staticProps&&multipleChoiceField_defineProperties(Constructor,staticProps),Constructor}var MultipleChoiceController=function(){function MultipleChoiceController($ngRedux,$scope,$element,$timeout,AnswerActions){var _this=this;multipleChoiceField_classCallCheck(this,MultipleChoiceController),this.dispatch=$ngRedux.dispatch,this.getState=$ngRedux.getState,this.$scope=$scope,this.$element=$element,this.$timeout=$timeout,this.AnswerActions=AnswerActions,this.clear=function(){return _this.data.input={}}}return multipleChoiceField_createClass(MultipleChoiceController,[{key:"getDisplayClass",value:function(choice){return choice.is_failure?"btn-danger":"btn-success"}},{key:"update",value:function(choice){var _this2=this,input=choice.data,_suggested_response=choice._suggested_response;Object.assign(this.answer.data,{input:input,_suggested_response:_suggested_response}),this.$timeout(function(){return _this2.$scope.$digest()},0)}},{key:"clickUpdate",value:function(choice){this.update(choice);var andSave=this.getState().settings.interactions.autoSubmitMultipleChoice;this.hooks.update(andSave,choice)}}]),MultipleChoiceController}(),multipleChoiceField_MultipleChoiceInputController=function(){function MultipleChoiceInputController(){multipleChoiceField_classCallCheck(this,MultipleChoiceInputController),this.getClasses=es.a.apply(void 0,multipleChoiceField_toConsumableArray(this.inputSelectors()).concat([this.classesGetter]))}return multipleChoiceField_createClass(MultipleChoiceInputController,[{key:"inputSelectors",value:function(){var _this3=this;return[function(){return _this3.selectedClass},function(){return _this3.isSelected},function(){return _this3.isDisabled}]}},{key:"classesGetter",value:function(selectedClass,isSelected,isDisabled){var _ref;return multipleChoiceField_defineProperty(_ref={},selectedClass,isSelected),multipleChoiceField_defineProperty(_ref,"disabled",isDisabled),_ref}}]),MultipleChoiceInputController}();var currentAnswer_inputSelectors=[currentQuestion,function(state){return state.entities.answers}];var multipleChoiceSelectedChoice_inputSelectors=[currentQuestion,es.a.apply(void 0,currentAnswer_inputSelectors.concat([function(question,answers){return answers[question.answer]}])),function(state){return state.entities.temporaryAnswer}];es.a.apply(void 0,multipleChoiceSelectedChoice_inputSelectors.concat([function(question,answer,temporaryAnswer){if(!question)return{};if(answer)return _.find(question.choices,{choice:answer.answer});if(temporaryAnswer[question.id]){var _answer=temporaryAnswer[question.id].answer;return _.find(question.choices,{choice:_answer})}return{}}]));function cascadeField_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function cascadeField_toConsumableArray(arr){return function(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function cascadeField_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function cascadeField_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function cascadeField_createClass(Constructor,protoProps,staticProps){return protoProps&&cascadeField_defineProperties(Constructor.prototype,protoProps),staticProps&&cascadeField_defineProperties(Constructor,staticProps),Constructor}var customValuePrefixRE=new RegExp("^"+"(Custom) ".replace(/[()]/g,"\\$&")),cascadeField_CascadeFieldController=function(){function CascadeFieldController($ngRedux,$scope,$element,$timeout,$interpolate){var _this=this;cascadeField_classCallCheck(this,CascadeFieldController),this.$element=$element,this.$timeout=$timeout,this.$interpolate=$interpolate,this.clear=function(){return _this.selections.fill(null)},this.getSelectedChoice=function(i){return _this.selectedChoiceGetter($ngRedux.getState())},this.setSelectedChoice=function(){return _this.selectedChoice=_this.getSelectedChoice($ngRedux.getState())},this.setSelectedChoice(),this.spec=collector.collectors[this.question.collection_request].full_specification.instruments_info.instruments[this.question.id],this.labels=this.spec.response_info.method.labels,this.labelCodes=this.spec.response_info.method.label_codes,this.choicesLookups=this.spec.response_info.method.source_structured,this.choices=[],this.selections=[],this.selections.length=this.labels.length,this.clear(),this.updateChoices(),$scope.$on("$destroy",$ngRedux.subscribe(function(){return _this.setSelectedChoice()})),$scope.$on("$destroy",$scope.$watch(function(){return _this.question},function(){return _this.setSelectedChoice()},!0))}return cascadeField_createClass(CascadeFieldController,[{key:"isChoiceSelected",value:function(choice){return this.selectedChoice&&this.selectedChoice.id===choice.id}},{key:"getDisplayClass",value:function(choice){return choice.display_as_failure||choice.is_considered_failure?"btn-danger":"btn-success"}},{key:"getPlaceholderText",value:function(index){return this.isAvailable(index)?index==this.choices.length-1?"(Search)":"(Search or manually enter)":""}},{key:"getChoices",value:function(index){for(var _this2=this,lookups=this.choicesLookups,i=0;i<index&&null!==selection;i++){var selection=this.selections[i];lookups=lookups[selection]||{}}if(_.isArray(lookups)){var leafFormat=this.spec.response_info.method.leaf_display_format;lookups=_.slice(lookups).map(function(choice){return _this2.format(leafFormat,choice)})}else lookups=_.keys(lookups);return lookups}},{key:"format",value:function(spec,data){return spec=spec.replace(/\{/g,"[[ ").replace(/\}/g," ]]"),this.$interpolate(spec)(data)}},{key:"isAvailable",value:function(index){if(this.isDisabled)return!1;var isLeafChoice=this.choices.length==index,isSingleChoice=1===this.choices[index].length;if(isLeafChoice&&isSingleChoice)return!1;var isFirst=0===index,isPopulated=null!==this.selections[index],isFollowsPopulated=null!==this.selections[index-1],isFollowsSkipped="N/A"===this.selections[index-1];return isFirst||isPopulated||isFollowsPopulated||isFollowsSkipped}},{key:"hasCustomChoice",value:function(){return 0<_.filter(_.map(this.selections,function(v){return customValuePrefixRE.test(v)})).length}},{key:"selectedChoiceGetter",value:function(state){return this.answer?this.answer.data.input:state.entities.temporaryAnswer[this.question.id]?state.entities.temporaryAnswer[this.question.id].answer:{}}},{key:"refreshHandler",value:function(index,search){this.updateChoices(index,search)}},{key:"changeHandler",value:function(index,search){this.truncateRemaining(index),this.updateChoices();var data={choice:this.getChoiceInfo()},leafPosition=this.labelCodes[this.labelCodes.length-1];data.choice[leafPosition]||this.hasCustomChoice()||(data=null),null!==data&&(this.answer.data.input=data.choice,this.hooks.update(!1,data.choice))}},{key:"getChoiceInfo",value:function(){var _this3=this,info={};return this.selections.map(function(selection,i){return info[_this3.labelCodes[i]]=function(selection){return null!==selection&&(selection=selection.replace(customValuePrefixRE,"")),selection}(selection)}),info}},{key:"updateChoices",value:function(index,search){var _this4=this;function _filterChoices(choices,search,isLeaf,lowercaseChoices){choices=_.filter(choices,function(choice){return choice.match(new RegExp(".*"+search+".*","i"))}),isLeaf||-1===lowercaseChoices.indexOf(search.toLowerCase())&&choices.push("(Custom) "+search);return choices}function _injectCurrentSelection(choices,selection,lowercaseChoices){-1===lowercaseChoices.indexOf(selection.toLowerCase())&&choices.push(selection)}for(var i in this.answer.id&&_.forOwn(this.answer.data.input,function(v,k){var i=_this4.labelCodes.indexOf(k);_this4.selections[i]=v}),this.selections){this.choices[i]=this.getChoices(i);var lowercaseChoices=_.map(this.choices[i],function(s){return s.toLowerCase()});if(search&&index==i){var isLeaf=index==this.selections.length-1;this.choices[i]=_filterChoices(this.choices[i],search,isLeaf,lowercaseChoices)}null!==this.selections[i]&&_injectCurrentSelection(this.choices[i],this.selections[i],lowercaseChoices),1===this.choices[i].length&&(this.selections[i]=this.choices[i][0])}}},{key:"truncateRemaining",value:function(index){this.selections.fill(null,index+1)}}]),CascadeFieldController}(),cascadeField_cascadeOptionController=function(){function cascadeOptionController(){cascadeField_classCallCheck(this,cascadeOptionController),this.getClasses=es.a.apply(void 0,cascadeField_toConsumableArray(this.inputSelectors()).concat([this.classesGetter]))}return cascadeField_createClass(cascadeOptionController,[{key:"inputSelectors",value:function(){var _this5=this;return[function(){return _this5.selectedClass},function(){return _this5.isSelected},function(){return _this5.isDisabled}]}},{key:"classesGetter",value:function(selectedClass,isSelected,isDisabled){var _ref;return cascadeField_defineProperty(_ref={},selectedClass,isSelected),cascadeField_defineProperty(_ref,"disabled",isDisabled),_ref}}]),cascadeOptionController}();function dateInputField_DateInputController($element,$timeout){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,dateInputField_DateInputController),this.question&&(this.placeholder=PLACEHOLDERS[this.question.type]||"",this.tooltip=TOOLTIPS[this.question.type]||"",this.isRelatedAnswer||$timeout(function(){$element.find("input").focus()},0))}function openInputField_OpenInputController($element,$timeout){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,openInputField_OpenInputController),this.question&&(this.placeholder=PLACEHOLDERS[this.question.type]||"",this.tooltip=TOOLTIPS[this.question.type]||"",this.isRelatedAnswer||$timeout(function(){$element.find("input").focus()},0))}__webpack_exports__.default=angular.module("collection",["ui.bootstrap","ui.router",ng_redux.a,lib_default.a]).config(function($urlRouterProvider,$stateProvider){configs_isHomePage||$urlRouterProvider.otherwise("/"),$stateProvider.state("checklist",checklistList).state("checklist.detail",checklistDetail).state("checklist.settings",settings)}).config(function($ngReduxProvider){var logger=Object(redux_logger.createLogger)({level:"info",collapsed:!0});$ngReduxProvider.createStoreWith(redux_rootReducer,["ngUiRouterMiddleware",redux_thunk_es.a,logger,function(store){return function(next){return function(action){var result=next(action);return window.state=store.getState(),window.store=store,result}}}])}).config(function($httpProvider){$httpProvider.defaults.xsrfCookieName="csrftoken",$httpProvider.defaults.xsrfHeaderName="X-CSRFToken"}).run(function($transitions,$rootScope,$state){var name=window.location.hash.replace("#/","").replace("/",".");name=name||"tabs.programs";var unhook=$transitions.onStart({},function(){$rootScope.$emit("$stateChangeStart",{name:name},{},$state.current,{}),unhook()})}).service("QuestionActions",function($q,$http){return{setSearchString:saveToLocalStorage(function(value){return{type:"SET_FILTER_STRING",payload:{value:value}}}),setSearchCheckBox:saveToLocalStorage(function(key,value){return{type:"SET_FILTER_CHECKBOX",payload:{key:key,value:value}}})}}).service("AnswerActions",function($ngRedux,$http,$q,InteractionActions){var csrftoken=function(name){var cookieValue=null;if(document.cookie&&""!=document.cookie)for(var cookies=document.cookie.split(";"),i=0;i<cookies.length;i++){var cookie=jQuery.trim(cookies[i]);if(cookie.substring(0,name.length+1)==name+"="){cookieValue=decodeURIComponent(cookie.substring(name.length+1));break}}return cookieValue}("csrftoken");function updateInstruments(dispatch,userRole){return function(instrumentList){return entitiesActions($http).addInstruments(instrumentList,userRole,dispatch),instrumentList}}return{stage:function(instrument,data){return function(dispatch,getState){dispatch(function(questionId,answer,suggestedResponse){return{type:STORE_OPEN_ANSWER,payload:{questionId:questionId,answer:answer,suggestedResponse:suggestedResponse}}}(instrument.measure,data))}},save:function(instrument,data,customerDocuments){return function(dispatch,getState){var autoAdvanceOnAnswer=getState().settings.interactions.autoAdvanceOnAnswer;return $q.when().then(function(){return!0}).then(function(){return dispatch({type:SAVING_ANSWER})}).catch(errorHandler(clientError)).then(function(){return function(instrument,stagedData,customerDocuments){var data={instrument:instrument.id,data:stagedData,expected_documents:_.map(customerDocuments,function(document){return document.name})};collector.setCollector(instrument.collection_request);var promise=collector.api.promise.inputAdd(data,{},csrftoken),handler=errorHandler(serverError);return promise.then(handler,handler)}(instrument,data,customerDocuments)}).then(updateInstruments(dispatch,instrument.user_role)).then(function(){$q.all(_.map(customerDocuments,function(document){return function(document){return $http.post("/api/v2/checklist/documents/?machinery=input-collection",{document_raw:document.raw,document_raw_name:document.name,object_id:$ngRedux.getState().entities.answers[instrument.measure].id}).then(function(response){return response.data.object})}(document).then(function(document){return dispatch(function(document,answerId){return{type:ATTACH_DOCUMENT,payload:{document:document,answerId:answerId}}}(document,instrument.measure)),document})}))}).then(function(){return dispatch(remove(instrument.measure))}).then(function(){autoAdvanceOnAnswer&&dispatch(InteractionActions.gotoNextQuestion(instrument.measure))}).finally(function(){return dispatch({type:ANSWER_SAVED})});function errorHandler(handler){return function(_ref){var json=_ref.json,status=_ref.status;return void 0!==json.length?(dispatch(function(questionId){return{type:constants_interactions.REMOVE_ERROR,payload:{questionId:questionId}}}(instrument.measure)),json):(400===status&&dispatch(handler(json,instrument.measure)),$q.reject())}}}},retract:function(measure){return function(dispatch,getState){var entities=getState().entities,instrument=entities.questions[measure],answer=entities.answers[measure];collector.setCollector(instrument.collection_request);var activeRole=collector.collector.full_specification.user_role;return collector.api.promise.inputDelete({},{id:answer.id},csrftoken).then(function(instruments){return dispatch(function(measure){return{type:DELETE_ANSWER,payload:{answerId:measure}}}(measure)),instruments}).then(updateInstruments(dispatch,activeRole),function(){console.error("Handle errors for non retractable answers")})}},clear:function(measure){return function(dispatch,getState){dispatch(remove(measure))}},updateComment:updateComment,storeDocument:function(file,measure){return function(dispatch,getState){dispatch(function(file,questionId){return{type:STORE_DOCUMENTS_SHELL,payload:{file:file,questionId:questionId}}}(file,measure));var reader=new FileReader;reader.onload=function(readFile){var raw=readFile.target.result,extension=file.name.split(".").pop();-1<raw.indexOf(":;")?raw=raw.replace(":;",":application/".concat(extension,";")):-1<raw.indexOf("octet-stream")&&(raw=raw.replace("octet-stream",extension)),file.raw=raw,$http.post("/api/v2/answer/documents/validate/",{document:raw}).then(function(){return dispatch(function(file,questionId){return{type:STORE_DOCUMENT,payload:{file:file,questionId:questionId}}}(file,measure))}).catch(function(response){dispatch(function(fileName,questionId){return{type:REMOVE_DOCUMENT_SHELL,payload:{fileName:fileName,questionId:questionId}}}(file.name,measure)),dispatch(function(errors,questionId){return{type:constants_interactions.SERVER_ERROR,payload:{questionId:questionId,errors:["Document is invalid"]}}}(response.data,measure))})},reader.readAsDataURL(file.file)}},removeDocument:removeDocument,stateGo:lib.stateGo}}).service("InteractionActions",function(){return{setSetting:setSetting,setInteractionSetting:function(key,value){return function(dispatch,getState){dispatch({type:"SET_INTERACTION_SETTING",payload:{key:key,value:value}}),localStorage.setItem("checklist:interaction_settings",JSON.stringify(getState().settings.interactions))}},gotoNextQuestion:function(measure){return function(dispatch,getState){var state=getState(),nextId=function getNextQuestionId(state,measure,skipAnswered){var nextMeasure=nextQuestionId(state);if(!nextMeasure)return measure;if(!skipAnswered||!state.entities.answers[nextMeasure])return nextMeasure;try{return getNextQuestionId(state,nextMeasure,skipAnswered)}catch(e){return measure}}(state,measure,state.settings.interactions.skipAnsweredQuestions);dispatch(Object(lib.stateGo)("checklist.detail",{id:nextId}))}},gotoPreviousQuestion:function(measure){return function(dispatch,getState){var previousId=function(state){return previousQuestionId(state)}(getState());dispatch(Object(lib.stateGo)("checklist.detail",{id:previousId}))}},setInteractionSettingVisibility:function(value){return{type:"SET_SHOW_INTERACTION_SETTINGS",payload:{value:value}}},setFilterSettingVisibility:function(value){return{type:"SET_SHOW_FILTER_SETTINGS",payload:{value:value}}}}}).service("FilterActions",function(){return{setSearchString:filters_setSearchString,setTypeCheckbox:setTypeCheckbox,setStateCheckbox:setStateCheckbox,setSectionCheckbox:setSectionCheckbox,setProgramCheckbox:setProgramCheckbox,resetFilters:resetFilters}}).service("EntitiesActions",entitiesActions).directive("fileTable",function(){return{scope:{label:"@",acceptedTypes:"@",documents:"=",documentsUploader:"=",relatedDocuments:"=",relatedDocumentsUploader:"=",showRelatedDocuments:"=",canAdd:"=",addCallback:"&",removeCallback:"&"},controller:function(){var _this=this;this.add=function(name,file,extension){_this.addCallback({name:name,file:file,extension:extension})},this.remove=function(doc){_this.removeCallback({doc:doc})}},controllerAs:"table",bindToController:!0,template:"\n        <table class='table table-striped table-bordered'>\n            <thead>\n                <th>\n                    [[ table.label ]]\n                    <i class=\"fa fa-info-circle\" tooltip=\"Accepted File Types: [[table.acceptedTypes]]\"></i>\n                </th>\n                <th>[[ table.canAdd ? 'Delete' : '' ]]</th>\n            </thead>\n            <tbody>\n                <tr file-display ng-if=\"table.showRelatedDocuments\" ng-repeat=\"doc in table.relatedDocuments\" doc=\"doc\" uploaded-by=\"table.relatedDocumentsUploader\"></tr>\n                <tr file-display ng-repeat='doc in table.documents' doc='doc' uploaded-by=\"table.documentsUploader\" remove-callback='table.remove(doc)'></tr>\n                <tr ng-if='!table.canAdd && !table.documents.length' class='text-center'>\n                    <td colspan='2'>No Documents</td>\n                </tr>\n\n                <tr ng-if='table.canAdd'>\n                    <td>\n                        <file-input callback='table.add(name, file, extension)'></file-input>\n                    </td>\n                    <td></td>\n                </tr>\n            </tbody>\n        </table>\n        ",replace:!0}}).directive("inputCollector",function(){return{scope:{homeId:"="},controller:CollectionAppController,controllerAs:"collection",bindToController:!0,template:'\n        <div class="row">\n            <div class="col-sm-3">\n                <checklist-progress-bar></checklist-progress-bar>\n                <hr>\n                <question-filter-settings></question-filter-settings>\n                <user-settings></user-settings>\n            </div>\n            <div class="col-sm-9">\n                <div ui-view="detail"></div>\n                <hr>\n                <question-list></question-list>\n            </div>\n        </div>\n        '}}).directive("userSettings",function(){return{scope:{},controller:userSettings_UserSettingsController,controllerAs:"ctrl",template:'\n        <h3>User Settings</h3>\n        <div class="panel panel-default">\n            <div class="panel-heading">\n                <h3 class="panel-title">Interaction Settings</h3>\n            </div>\n            <div class="list-group">\n                <label class="list-group-item" ng-repeat="key in ctrl.interactionOrder">\n                    <input type="checkbox" ng-checked="ctrl.interactions[key]" ng-click="ctrl.toggleSetting(key, ctrl.interactions[key])" /> [[ ::ctrl.labels[key] ]]\n                </label>\n            </div>\n            <div class="panel-heading" ng-if="ctrl.showDisplay">\n                <h3 class="panel-title">Display Settings</h3>\n            </div>\n            <div class="list-group" ng-if="ctrl.showDisplay">\n                <label class="list-group-item" ng-repeat="key in ctrl.displayOrder">\n                    <input type="checkbox" ng-checked="ctrl.display[key]" ng-click="ctrl.toggleSetting(key, ctrl.display[key])" /> [[ ::ctrl.labels[key] ]]\n                </label>\n            </div>\n        </div>'}}).directive("questionList",function(){return{controller:questionList_QuestionListController,controllerAs:"list",template:'\n            <search-field></search-field>\n            <br>\n            <li class="list-group-item text-center text-muted"\n                ng-if="list.totalQuestions != list.questionCount">\n                <small>Showing [[ list.questionCount ]] of [[ list.totalQuestions ]] questions.</small>\n            </li>\n            <div ng-switch="list.splitQuestionsByProgram">\n                <program-separated-list ng-switch-when="true"></program-separated-list>\n                <all-questions-list ng-switch-when="false"></all-questions-list>\n            </div>\n        '}}).directive("allQuestionsList",function(){return{template:'\n            <div class="list-group scrollable" scroller>\n                <question-list-items questions="list.questions" list="list"></question-list-items>\n            </div>\n        '}}).directive("programSeparatedList",function(){return{template:'\n            <div class="list-group list-group-root scrollable" scroller>\n                <div class="list-group" ng-repeat="(key, questions) in list.questions">\n                    <strong class="list-group-item text-muted" ng-bind="::list.eepPrograms[key].name"></strong>\n                    <div class="list-group">\n                        <question-list-items questions="questions" list="list"></question-list-items>\n                    </div>\n                </div>\n            </div>\n        '}}).directive("questionListItems",function(){return{scope:{questions:"=",list:"=",collector:"="},template:'\n        <li class="list-group-item text-center text-muted"\n            ng-if="questions.length != filteredQuestions.length">\n            <small>Search showing [[ filteredQuestions.length ]] of [[ questions.length ]] questions.</small>\n        </li>\n        <a ui-sref-active=\'active\'\n           ui-sref=\'checklist.detail({id: question.measure})\'\n           ng-class="list.questionColors[question.id]"\n           class="list-group-item"\n           id=\'question_[[::question.id]]\'\n           ng-repeat="question in questions | filter:{text: list.searchString} as filteredQuestions track by question.id">\n           <question-list-item question="question" list="list"></question-list-item>\n        </a>\n    <li class=\'list-group-item text-center\' ng-if=\'filteredQuestions.length == 0\'>\n        <i class="fa fa-fw fa-spin fa-spinner" ng-if="list.isFetching"></i>\n        No Questions\n    </li>\n    '}}).directive("questionListItem",function(){return{scope:{question:"=",list:"="},template:'\n            <div class="row">\n                <div class="col-sm-10">\n                    <i class="fa fa-fw fa-pencil" ng-if="!question.answer.id && list.temporaryAnswer[question.measure]"></i>\n                    <i class=\'fa fa-fw fa-exclamation-triangle\' ng-if=\'list.errors[question.measure]\'></i>\n                    <i class=\'fa fa-fw fa-long-arrow-right\' ng-if=\'question.parent_instruments.length && question.is_condition_met\'></i>\n                    <span ng-if="::!question.response_policy.required">(Optional)</span>\n                    <span ng-bind="::question.text"></span>\n\n                    <div ng-if="list.debug" class="row">\n                        <div class="col-sm-1"><code ng-bind="::question.collection_request"></code></div>\n                        <div class="col-sm-1"><span class="label label-default" ng-bind="::question.order"></span></div>\n                        <div class="col-sm-4"><span class="label label-primary" ng-bind="::question.measure"></span></div>\n                        <div class="col-sm-2"><span class="label label-warning" ng-bind="::question.type"></span></div>\n                        <div class="col-sm-2"><span class="label label-info" ng-bind="::question.segment"></span></div>\n                        <div class="col-sm-1"><span class="label label-info" ng-bind="::question.group"></span></div>\n                    </div>\n                </div>\n                <div class="col-sm-2">\n                    <div ng-bind="list.getAnswerPreview(question.measure) || \'-\'"></div>\n                    <answer-misc answer="list.answerDisplay[question.measure]" show-comment-tooltip="true"></answer-misc>\n                </div>\n            </div>\n        '}}).directive("questionDetail",function(){return{controller:questionDetail_QuestionDetailController,controllerAs:"detail",template:'\n            <div class="row">\n                <div class="col-xs-12">\n                    <div class="row">\n                        <div class="col-xs-6">\n                            <checklist-actions\n                                previous="detail.previous()"\n                                save="detail.save()"\n                                next="detail.next()"\n                                is-save-disabled="detail.saveDisabled"\n                                is-saving="detail.isSaving"\n                            ></checklist-actions>\n                        </div>\n                        <div class="col-xs-6 text-right">\n                            <a class="btn btn-default btn-xs" ng-if="detail.canRetract" ng-click="detail.retract()">Retract</a>\n                        </div>\n                    </div>\n                    <br>\n\n                    \x3c!--Question--\x3e\n                    <div class="row" style="min-height: 3.5em;">\n                        <div class="col-md-12">\n                            <p><strong>[[ detail.question.text ]]</strong></p>\n                        </div>\n                    </div>\n\n                    \x3c!--Related Answer--\x3e\n                    <div class="row" ng-if="detail.showRelatedAnswers && detail.relatedAnswer.id">\n                        <div class="col-xs-10">\n                            <checklist-field\n                                hooks="detail.hooks"\n                                question="detail.question"\n                                answer="detail.relatedAnswer"\n                                is-disabled="true"\n                            ></checklist-field>\n                        </div>\n                        <div class="col-xs-2">\n                            <answered-by answer="detail.relatedAnswer"></answered-by>\n                            <pending-review answer="detail.relatedAnswer"></pending-review>\n                            <answer-misc answer="detail.relatedAnswer"></answer-misc>\n                        </div>\n                    </div>\n\n                    \x3c!--Description--\x3e\n                    <div ng-if="detail.question.description">\n                        <p ng-bind-html="detail.trustAsHtml(detail.question.description)"></p>\n                    </div>\n\n                    \x3c!--Answer--\x3e\n                    <div class="row" ng-if="detail.showRelatedAnswers && !detail.relatedAnswer.id || !detail.question.read_only">\n                        <div class="col-xs-10">\n                            <checklist-field\n                                hooks="detail.hooks"\n                                question="detail.question"\n                                answer="detail.answer"\n                                is-disabled="detail.isDisabled"\n                            ></checklist-field>\n                        </div>\n                        <div class="col-xs-2">\n                            <answered-by answer="detail.answer"></answered-by>\n                            <pending-review answer="detail.answer"></pending-review>\n                            <answer-misc answer="detail.answer" ng-if="detail.answer.id"></answer-misc>\n                            <choice-misc answer="detail.answer" ng-if="!detail.answer.id"></choice-misc>\n                        </div>\n                    </div>\n\n                    \x3c!--Errors--\x3e\n                    <div class="row" ng-if="detail.errors">\n                        <div class="col-xs-12">\n                            <ul class="list-group" ng-repeat="(errorField, errorList) in detail.errors">\n                                <list class="list-group-item list-group-item-danger" ng-repeat="error in errorList">[[ error ]]</list>\n                            </ul>\n                        </div>\n                    </div>\n\n                    \x3c!--Comments--\x3e\n                    <div class="row">\n\n                        \x3c!--Related Comment--\x3e\n                        <div class="col-xs-12" ng-if="detail.showRelatedAnswers && detail.relatedAnswer.id && detail.relatedAnswer.data.comment">\n                            <comment-display\n                                label="Original Comment"\n                                comment="detail.relatedAnswer.data.comment"\n                                commenter="detail.relatedAnswer.user.full_name"\n                            ></comment-display>\n                        </div>\n\n                        \x3c!--Comment--\x3e\n                        <div class="col-xs-12">\n                            <div class="form-group" ng-switch="detail.answer.id">\n                                <div class="controls" ng-switch-when="undefined">\n                                    <label class="control-label">Comment[[ detail.selectedChoice.comment_required ? \'*\' : \'\' ]]</label>\n                                    <textarea\n                                        ng-attr-placeholder="[[ detail.selectedChoice.comment_required ? "Comment Required..." : "Comment..." ]]"\n                                        ng-model="detail.answer.data.comment"\n                                        ng-disabled="detail.isDisabled"\n                                        class="textarea form-control" />\n                                </div>\n                                <comment-display ng-switch-default\n                                    ng-if="detail.answer.data.comment"\n                                    comment="detail.answer.data.comment"\n                                    commenter="detail.answer.user"\n                                ></comment-display>\n                            </div>\n                        </div>\n                    </div>\n\n                    \x3c!--Documents--\x3e\n                    <div class="row">\n                        <div class="col-xs-12">\n                            <file-table\n                                label="Documents[[ detail.selectedChoice.document_required ? \'*\' : \'\' ]] and Photos[[ detail.selectedChoice.photo_required ? \'*\' : \'\' ]]"\n                                accepted-types=".txt .pdf .doc .docx .xls .xlsx .png .jpeg .jpg"\n                                documents="detail.answer.customer_documents"\n                                documents-uploader="detail.answer.user.full_name"\n                                related-documents="detail.relatedAnswer.customer_documents"\n                                related-documents-uploader="detail.relatedAnswer.user.full_name"\n                                show-related-documents="detail.showRelatedAnswers"\n                                can-add="!detail.answer.id"\n                                add-callback="detail.documentCallback(name, file, raw, extension)"\n                                remove-callback="detail.removeDocument(doc)"\n                            ></file-table>\n\n                        </div>\n                    </div>\n\n                    \x3c!--Expanded Help--\x3e\n                    <div ng-if="detail.question.help">\n                        <button class="btn btn-link" ng-click="showHelp=!showHelp">[[ !showHelp ? \'Show\' : \'Hide\' ]] Help</button>\n                        <p collapse="!showHelp" ng-bind-html="detail.trustAsHtml(detail.question.help)"></p>\n                    </div>\n                </div>\n                <div ng-if="::detail.debug" ng-init="showDebugValues=true">\n                    <button ng-click="showDebugValues=!showDebugValues">Debugging</button>\n                    <dl class="dl-horizontal" ng-show="showDebugValues">\n                        <dt><code>[[ detail.question.measure ]]</code></dt>\n                        <dd><pre style="white-space: pre-line">\n                            id=[[ detail.question.id ]]\n                            measure=[[ detail.question.measure ]]\n                            collection_request_id=[[ detail.question.collection_request ]]\n                            read_only=[[ detail.question.read_only ]]\n                        </pre></dd>\n                        </dd>\n\n                        <dt>data</dt>\n                        <dd><code>[[ detail.answer.data|json ]]</code></dd>\n\n                        <dt>related @<code>[[ detail.question.measure ]]</code></dt>\n                        <dd><code>[[ detail.relatedAnswer|json ]]</code></dd>\n                        <dt>[[ detail.question.user_role ]] @<code>[[ detail.question.measure ]]</code></dt>\n                        <dd><code>[[ detail.answer|json ]]</code></dd>\n\n                        <dt>rater @<code>[[ detail.question.id ]]</code></dt>\n                        <dd><code>[[ detail.question.collectedinput_set.rater|json ]]</code></dd>\n                        <dt>qa @<code>[[ detail.question.id ]]</code></dt>\n                        <dd><code>[[ detail.question.collectedinput_set.qa|json ]]</code></dd>\n                    </dl>\n                </div>\n            </div>\n        '}}).directive("questionFilterSettings",function(){return{scope:{},controller:FilterSettingsController,controllerAs:"ctrl",template:'\n            <h3 style="margin-top: 0;">Filter Options</h3>\n            <div class="row">\n                <div class="col-sm-12">\n                    <a ng-click="ctrl.resetFilters($event)">\n                        <i class="fa fa-fw fa-refresh"></i>\n                        Reset Filters\n                    </a>\n                    <question-filter-setting-checkbox label="Question Display" prefix="Hide" lookup="states"></question-filter-setting-checkbox>\n                    <question-filter-setting label="EEP Programs" lookup="programs"></question-filter-setting>\n                    <question-filter-setting label="Checklist Sections" lookup="sections"></question-filter-setting>\n                </div>\n            </div>\n        '}}).directive("questionFilterSetting",function(){return{scope:{label:"@",lookup:"@"},controller:filterSettings_SingleFilterController,controllerAs:"ctrl",bindToController:!0,template:'\n            <div class="form-group" ng-if="ctrl[ctrl.lookup].length > 1">\n                <label>\n                    [[ ctrl.label ]]\n                </label>\n                <multi-select\n                    name="question_[[ ctrl.lookup ]]"\n                    on-item-click="ctrl.toggleBox(data)"\n                    helper-elements=""\n                    button-label="name"\n                    item-label="name"\n                    input-model="ctrl[ctrl.lookup]"\n                    output-model="ctrl.outputs"\n                    tick-property="selected" >\n                </multi-select>\n            </div>\n        '}}).directive("questionFilterSettingCheckbox",function(){return{scope:{label:"@",lookup:"@",prefix:"@"},controller:filterSettings_SingleFilterController,controllerAs:"ctrl",bindToController:!0,template:'\n            <div class="panel filter-panel panel-default form-group" ng-if="ctrl[ctrl.lookup].length > 1">\n                <div class="panel-heading">[[ ctrl.label ]]</div>\n                <ul class="list-group">\n                    <li class="list-group-item" ng-repeat="box in ctrl[ctrl.lookup]">\n                        <label>\n                            <input type="checkbox" ng-checked="!box.selected" ng-click="ctrl.toggleBox({key: box.key, selected: !box.selected})"> [[ ctrl.prefix || \'\' ]] [[ box.name ]] &emsp;\n                        </label>\n                    </li>\n                </ul>\n            </div>\n        '}}).directive("openInput",function(){return{scope:{question:"=",answer:"=",isDisabled:"=",isRelatedAnswer:"=",hooks:"="},replace:!0,controller:openInputField_OpenInputController,controllerAs:"input",bindToController:!0,template:'\n        <div class=\'form-group\'>\n            <form class=\'controls\' ng-submit=\'ctrl.hooks.save()\'>\n                <div class="input-group" ng-if="input.question.unit">\n                    <input type=\'text\'\n                        class="textinput textInput form-control"\n                        name="input.question.measure"\n                        ng-model="input.answer.data.input"\n                        ng-change=\'input.hooks.update()\'\n                        ng-attr-placeholder=\'[[ input.placeholder ]]\'\n                        ng-readonly=\'input.isDisabled\'\n                        />\n                    <span class="input-group-addon">[[ input.question.unit  ]]</span>\n                </div>\n                <input type="text"\n                    class="textinput textInput form-control"\n                    ng-model="input.answer.data.input"\n                    ng-change="input.hooks.update()"\n                    ng-attr-placeholder="[[ input.placeholder ]]"\n                    ng-readonly="input.isDisabled"\n                    ng-if="!input.question.unit">\n            </form>\n        </div>\n        '}}).directive("dateInput",function(){return{scope:{question:"=",answer:"=",isDisabled:"=",isRelatedAnswer:"=",hooks:"="},replace:!0,controller:dateInputField_DateInputController,controllerAs:"input",bindToController:!0,template:'\n        <div class=\'form-group\'>\n            <form class=\'controls\' ng-submit=\'ctrl.hooks.save()\'>\n                <div class="row">\n                    <div class="col-md-5">\n                        <input type=\'text\'\n                            class="textinput textInput form-control"\n                            name="input.question.measure"\n                            ng-model="input.answer.data.input"\n                            ng-change=\'input.hooks.update()\'\n                            ng-attr-placeholder=\'[[ input.placeholder ]]\'\n                            ng-readonly=\'input.isDisabled\'\n                            datepicker-popup="shortDate"\n                            />\n                    </div>\n                </div>\n                <div class="row" style="margin-top: 2px">\n                    <div class="col-md-5 text-center">\n                        <datepicker\n                            class="well well-sm"\n                            show-weeks="false"\n                            ng-model="input.answer.data.input"\n                            date-disabled="input.isDisabled"\n                            />\n                    </div>\n                </div>\n            </form>\n        </div>\n        '}}).directive("fileInput",function(){return{scope:{callback:"&"},link:function(scope,elem,attrs){var input=elem.find('input[type="file"]'),jasny=elem.find(".fileinput");input.bind("change",function(event){var clearFn=_.after(event.target.files.length,function(){return jasny.fileinput("clear")});return _.map(event.target.files,function(file){var name=file.name,extension=name.split(".").pop();scope.callback({name:name,file:file,extension:extension}),clearFn()})})},template:'<div class="row">\n    <div class="col-xs-12">\n        <div class="form-group">\n            <div class="controls">\n                <div class="fileinput fileinput-new input-group" data-provides="fileinput">\n                    <div class="form-control" data-trigger="fileinput">\n                        <i class="icon-file fileinput-exists"></i>\n                        <span class="fileinput-filename"></span>\n                    </div>\n                        <span class="input-group-addon btn btn-default btn-file">\n                            <span class="fileinput-new">Select file</span>\n                            <span class="fileinput-exists">Change</span>\n                            <input name="fileupload" type="file" multiple/>\n                        </span>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n        '}}).directive("searchField",function(){return{scope:{},template:"<input type='text' class='form-control' placeholder='Search...' ng-model='ctrl.searchString'/>",controllerAs:"ctrl",controller:function($ngRedux,$scope,FilterActions){var _this=this;$scope.$on("$destroy",$scope.$watch(function(){return _this.searchString},function(newVal,oldVal){return $ngRedux.dispatch(FilterActions.setSearchString(newVal))})),$scope.$on("$destroy",$ngRedux.connect(function(state){return{searchString:state.filters.searchString}}.bind(this))(this))}}}).directive("commentField",function(){return{scope:{data:"=",commentRequired:"=",changeCallback:"&",question:"=",answer:"="},controller:CommentFieldInputController,controllerAs:"input",bindToController:!0,template:"\n        <div class='form-group'>\n            <div class='controls' ng-if='!input.data.id'>\n                <label class='control-label'>Comment[[ input.commentRequired ? '*' : '' ]]</label>\n                <textarea\n                    ng-attr-placeholder='[[ input.commentRequired ? \"Comment Required...\" : \"Comment...\" ]]'\n                    ng-model='input.data'\n                    ng-change='input.hooks.update()'\n                    class='textarea form-control' />\n            </div>\n            <comment-display\n                ng-if=\"input.data.id\"\n                comment=\"input.data.comment\"\n                commenter=\"input.data.user\"\n            ></comment-display>\n        </div>\n        "}}).directive("checklistField",function($compile){return{scope:{question:"=",answer:"=",isDisabled:"=",isRelatedAnswer:"=",hooks:"="},template:'\n        <div ng-switch="question.type">\n            <div ng-switch-when="multiple-choice">\n                <multiple-choice\n                    hooks="hooks"\n                    choices="question.suggested_responses"\n                    question="question"\n                    answer="answer"\n                    is-disabled="isDisabled"\n                    is-related-answer="isRelatedAnswer"\n                ></multiple-choice>\n            </div>\n            <div ng-switch-when=\'cascading-select\'>\n                <cascade-field\n                    hooks="hooks"\n                    question="question"\n                    answer="answer"\n                    is-disabled="isDisabled"\n                    is-related-answer="isRelatedAnswer"\n                    ></cascade-field>\n            </div>\n            <div ng-switch-when=\'date\'>\n                <date-input\n                    hooks="hooks"\n                    question="question"\n                    answer="answer"\n                    is-disabled="isDisabled"\n                    is-related-answer="isRelatedAnswer"\n                    ></date-input>\n            </div>\n            <div ng-switch-default>\n                <open-input\n                    hooks="hooks"\n                    question="question"\n                    answer="answer"\n                    is-disabled="isDisabled"\n                    is-related-answer="isRelatedAnswer"\n                ></open-input>\n            </div>\n        </div>\n        '}}).directive("multipleChoice",function(){return{scope:{hooks:"=",choices:"=",question:"=",answer:"=",isDisabled:"="},template:'\n        <div class="control btn-group form-group" data-toggle="buttons">\n            <multiple-choice-input\n                hooks="ctrl.hooks"\n                name="ctrl.question.measure"\n                label="choice.data"\n                ng-click="ctrl.clickUpdate(choice)"\n                is-selected="ctrl.answer.data.input == choice.data"\n                selected-class="ctrl.getDisplayClass(choice)"\n                is-disabled="ctrl.isDisabled"\n                ng-repeat="choice in ctrl.choices"\n            ></multiple-choice-input>\n        </div>\n        ',controller:MultipleChoiceController,controllerAs:"ctrl",bindToController:!0}}).directive("multipleChoiceInput",function(){return{scope:{hooks:"=",name:"=",label:"=",isDisabled:"=",isSelected:"=",selectedClass:"="},template:'\n        <label class="btn btn-default" ng-class="input.getClasses()">\n            <input type="radio"\n                name="[[ input.name ]]"\n                ng-class="[[ isSelected ? input.selectedClass : \'\' ]]"\n                ng-value="input.label"\n                ng-disabled="input.isDisabled" /> [[ input.label ]]\n        </label>\n        ',replace:!0,controller:multipleChoiceField_MultipleChoiceInputController,controllerAs:"input",bindToController:!0}}).directive("cascadeField",function(){return{scope:{hooks:"=",tableLookup:"=",question:"=",answer:"=",isDisabled:"=",answerCallback:"&"},template:'\n        <div class="form-group"\n             ng-repeat="label in ctrl.labels">\n            <label>[[ label ]]</label>\n\n            <div ng-switch="$last && ctrl.hasCustomChoice()">\n                <p ng-switch-when="true">\n                    <em>No characteristics available for manually submitted equipment.</em>\n                </p>\n\n                <div ng-switch-default>\n                    <ui-select ng-model="ctrl.selections[$index]"\n                               theme="bootstrap"\n                               ng-change="ctrl.changeHandler($index)"\n                               ng-disabled="!ctrl.isAvailable($index)"\n                               reset-search-input="true"\n                        >\n                        <ui-select-match ng-attr-placeholder="[[ ctrl.getPlaceholderText($index) ]]">\n                            [[ $select.selected ]]\n                        </ui-select-match>\n                        <ui-select-choices repeat="choice in ctrl.choices[$index] track by $index"\n                                           refresh="ctrl.refreshHandler($index, $select.search)"\n                                           refresh-delay="0">\n                            <div ng-bind="choice"></div>\n                        </ui-select-choices>\n                    </ui-select>\n                </div>\n            </div>\n        </div>\n        ',controller:cascadeField_CascadeFieldController,controllerAs:"ctrl",bindToController:!0}}).directive("cascadeOption",function(){return{scope:{label:"=",isSelected:"="},template:"\n        <option ng-value='input.label'>[[ input.label ]]</option>\n        ",replace:!0,controller:cascadeField_cascadeOptionController,controllerAs:"input",bindToController:!0}}).directive("answeredBy",function(){return{scope:{answer:"="},template:"\n        <small ng-if='answer.id'>\n            By: [[ answer.user.full_name ]] <br>\n            On: [[ answer.date_created | date:'shortDate' ]]\n        </small>\n        "}}).directive("answerMisc",function(){return{scope:{answer:"=",showCommentTooltip:"="},template:"\n        <div>\n            <i class='fa fa-fw fa-comment-o' ng-if='answer.data.comment && showCommentTooltip' tooltip=\"[[ answer.data.comment ]]\"></i>\n            <i class='fa fa-fw fa-comment-o' ng-if='answer.data.comment && !showCommentTooltip'></i>\n            <i class='fa fa-fw fa-picture-o' ng-if='answer.answerimage_set.length'></i>\n            <i class='fa fa-fw fa-file-text' ng-if='answer.answerdocument_set.length || answer.customer_documents.length'></i>\n        </div>\n        "}}).directive("choiceMisc",function(){return{scope:{choice:"="},template:"\n        <div>\n            <i class='fa fa-fw fa-comment-o' ng-if='choice.comment_required'></i>\n            <i class='fa fa-fw fa-picture-o' ng-if='choice.photo_required'></i>\n            <i class='fa fa-fw fa-file-text' ng-if='choice.document_required'></i>\n        </div>\n        "}}).directive("fileDisplay",function(){return{scope:{doc:"=",removeCallback:"&",uploadedBy:"="},template:'\n        <tr>\n            <td ng-if="doc.id">\n                <a ng-href="[[ doc.document ]]">\n                <i class="fa fa-cloud-download"></i>\n                [[ doc.filename ]]\n                </a>\n                <small class="text-muted" ng-if="doc.filesize">\n                    ([[ doc.filesize | bytes ]])\n                </small>\n                <small class="text-muted" ng-bind="uploadedBy"></small>\n            </td>\n            <td ng-if="!doc.id">\n                <i class="fa fa-fw fa-spin fa-spinner fa-lg" ng-if="doc.isLoading"></i>\n                [[ doc.name || doc.filename ]]\n                <small class="text-muted" ng-if="doc.file.size">([[ doc.file.size | bytes ]])</small>\n            </td>\n            <td>\n                <a ng-if="!doc.id" ng-click="removeCallback({doc: doc})"><i class="fa fa-fw fa-times"></i></a>\n            </td>\n        </tr>\n        ',replace:!0}}).directive("pendingReview",function(){return{scope:{answer:"="},template:"<em ng-if='reviewIsPending'>Pending Review</em>",link:function(scope){scope.reviewIsPending=function(){var answer=scope.answer;if(answer){var confirmed=answer.confirmed,is_considered_failure=answer.is_considered_failure,failure_is_reviewed=answer.failure_is_reviewed;return!confirmed&&is_considered_failure&&!failure_is_reviewed}return!1}()}}}).directive("commentDisplay",function(){return{scope:{label:"@",comment:"=",commenter:"="},template:'\n        <div>\n            <label class="control-label">[[ label || \'Comment\' ]]</label>\n            <blockquote>\n                <p>[[ comment ]]</p>\n                <footer ng-if="commenter">[[ commenter ]]</footer>\n            </blockquote>\n        </div>\n        '}}).directive("checklistProgressBar",function(){return{controller:function($scope,$ngRedux){var _this=this;$scope.$on("$destroy",$ngRedux.connect(questionsStatistics)(this)),$scope.$on("$destroy",$ngRedux.connect(function(state){return{processing:state.settings.savingAnswer}})(this)),this.getKlasses=function(){return _this.processing?"progress-bar-striped active":""},this.calculateSuccess=function(){return _this.answeredRequiredQuestions/_this.totalQuestions*100},this.calculateInfo=function(){return _this.answeredOptionalQuestions/_this.totalQuestions*100}},controllerAs:"ctrl",template:'\n        <div ng-if="ctrl.totalQuestions">\n            <h5>\n                <div> [[ ctrl.remainingRequiredQuestions ]] of [[ ctrl.totalRequiredQuestions ]] Required Questions Remaining. </div>\n                <div ng-if="ctrl.totalOptionalQuestions"> [[ ctrl.remainingOptionalQuestions ]] of [[ ctrl.totalOptionalQuestions ]] Optional Questions Remaining. </div>\n            </h5>\n            <progress>\n                <bar class="[[ ctrl.getKlasses() ]]" value="ctrl.calculateSuccess()" type="success"></bar>\n                <bar class="[[ ctrl.getKlasses() ]]" value="ctrl.calculateInfo()" type="info"></bar>\n            </progress>\n        </div>\n        '}}).directive("retract",function(){return{scope:{answer:"=",retractCallback:"&"},template:"<a class='btn btn-default btn-xs' ng-if='answerIsRetractable()' ng-click='retractCallback()'>Retract</a>",link:function(scope){scope.answerIsRetractable=function(){var answer=scope.answer;if(answer){var confirmed=answer.confirmed,is_considered_failure=answer.is_considered_failure;return!confirmed&&!is_considered_failure&&!READONLY}return!1}}}}).directive("checklistActions",function(){return{scope:{previous:"&",save:"&",isSaveDisabled:"=",isSaving:"=",next:"&"},controller:checklistActions_ChecklistActionsController,controllerAs:"actions",bindToController:!0,template:"\n        <div class='btn-group'>\n            <a class='btn btn-default' ng-disabled=\"actions.previousDisabled\" ng-click='actions.previous()'><i class='fa fa-angle-double-left'></i> Prev</a>\n            <a class='btn btn-primary' ng-click='actions.save()' ng-disabled='actions.saveDisabled()'>\n                <i class=\"fa fa-fw fa-spinner fa-spin\" ng-show=\"actions.isSaving\"></i>\n                Save\n            </a>\n            <a class='btn btn-default' ng-disabled=\"actions.nextDisabled\" ng-click='actions.next()'>Next <i class='fa fa-angle-double-right'></i></a>\n        </div>\n        "}}).directive("homeDetailDropdown",function(){return{scope:{},controller:function($ngRedux){var homeId=$ngRedux.getState().settings.homeId;this.homeDetailUrl="/home/".concat(homeId,"/")},controllerAs:"ctrl",template:'\n        <div class="btn-group">\n            <a role="button" ui-sref="checklist()" class="btn btn-default btn-xs">Home Detail</a>\n            <a ng-href="[[ ctrl.homeDetailUrl ]]" target="_blank" class="btn btn-default btn-xs"\n                tooltip="View full detail" tooltip-placement="bottom"\n            >\n                <i class="fa fa-external-link"></i>\n            </a>\n        </div>\n        '}}).directive("settingsButton",function(){return{scope:{},controller:function($ngRedux,FilterActions){this.resetFilters=function(e){e.preventDefault(),$ngRedux.dispatch(FilterActions.resetFilters())}},controllerAs:"ctrl",template:'\n            <a ui-sref="checklist.settings()" class="btn btn-default btn-xs">\n                <i class="fa fa-fw fa-cog"></i>\n                Settings\n            </a>\n        '}}).directive("scroller",function(){return{controller:function($scope,$ngRedux,$stateParams,$element){var unwatch=$scope.$watch(function(){return $stateParams.id},function(newVal,oldVal){if(0|newVal&&oldVal!=newVal){var activeEl=$element.find(".active");if(!activeEl.length)return;var currScroll=$element.scrollTop(),parentTop=$element.offset().top,selectedTop=activeEl.offset().top,parentBottom=parentTop+$element.outerHeight(),selectedBottom=selectedTop+activeEl.outerHeight();parentBottom<selectedBottom?$element.scrollTop(currScroll+(selectedBottom-parentBottom)):selectedTop<parentTop&&$element.scrollTop(currScroll-(parentTop-selectedTop))}});$scope.$on("$destroy",unwatch)}}}).filter("words",function(){return function(input,words){if(isNaN(words))return input;if(words<=0)return"";if(input){var inputWords=input.split(/\s+/);inputWords.length>words&&(input=inputWords.slice(0,words).join(" ")+"...")}return input}}).filter("bytes",function(){var units=["bytes","kB","MB","GB","TB","PB"];return function(bytes){var precision=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;if(0===bytes)return"0 bytes";if(isNaN(0|bytes||!isFinite(bytes)))return"-";var number=Math.floor(Math.log(bytes)/Math.log(1024)),val=(bytes/Math.pow(1024,Math.floor(number))).toFixed(precision);return"".concat(val.match(/\.0*$/)?val.substr(0,val.indexOf(".")):val," ").concat(units[number])}})},6:function(module,exports){module.exports=angular},77:function(module,exports){var utils,internals,api,DjangoInputCollection=(utils={tokenPattern:/__(\w+)__/g,extractEmptyContext:function(string,tokenPattern){tokenPattern=tokenPattern||utils.tokenPattern;var tokens={};return string.replace(tokenPattern,function(match,name){tokens[name]=void 0}),tokens},fillObject:function(object,source){var _iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=utils.locals(object)[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0)name=_step.value,source.hasOwnProperty(name)&&(object[name]=source[name])}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{_iteratorNormalCompletion||null==_iterator.return||_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}},interpolate:function(string,context,tokenPattern){tokenPattern=tokenPattern||utils.tokenPattern;var _iteratorNormalCompletion2=!0,_didIteratorError2=!1,_iteratorError2=void 0;try{for(var _step2,_iterator2=utils.locals(context)[Symbol.iterator]();!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=!0){var value=context[_step2.value];null!=value&&(string=string.replace(tokenPattern,value))}}catch(err){_didIteratorError2=!0,_iteratorError2=err}finally{try{_iteratorNormalCompletion2||null==_iterator2.return||_iterator2.return()}finally{if(_didIteratorError2)throw _iteratorError2}}return string},locals:function(o){var properties=new Set([]);for(var name in o)o.hasOwnProperty(name)&&properties.add(name);return properties.values()}},internals={generateApi:function(specification){var api={promise:{}},_iteratorNormalCompletion3=!0,_didIteratorError3=!1,_iteratorError3=void 0;try{for(var _step3,_iterator3=utils.locals(specification.endpoints)[Symbol.iterator]();!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=!0){var type=_step3.value,_iteratorNormalCompletion4=!0,_didIteratorError4=!1,_iteratorError4=void 0;try{for(var _step4,_iterator4=utils.locals(specification.endpoints[type])[Symbol.iterator]();!(_iteratorNormalCompletion4=(_step4=_iterator4.next()).done);_iteratorNormalCompletion4=!0){var operation=_step4.value,endpointInfo=specification.endpoints[type][operation],emptyContext=utils.extractEmptyContext(endpointInfo.url),name=type+operation.charAt(0).toUpperCase()+operation.substr(1);api[name]=internals.buildAction(type,operation,emptyContext,!1),api.promise[name]=internals.buildAction(type,operation,emptyContext,!0)}}catch(err){_didIteratorError4=!0,_iteratorError4=err}finally{try{_iteratorNormalCompletion4||null==_iterator4.return||_iterator4.return()}finally{if(_didIteratorError4)throw _iteratorError4}}}}catch(err){_didIteratorError3=!0,_iteratorError3=err}finally{try{_iteratorNormalCompletion3||null==_iterator3.return||_iterator3.return()}finally{if(_didIteratorError3)throw _iteratorError3}}return api},buildAction:function(type,operation,emptyContext,asPromise){return function(payload,extraContext,csrfToken){var context=Object.assign({},emptyContext);return utils.fillObject(context,extraContext),void 0!==payload&&utils.fillObject(context,payload),(asPromise?internals.promiseAction:internals.doAction)(type,operation,context,payload,csrfToken)}},promiseAction:function(type,operation,context,payload,csrfToken){return api.getPromise(type,operation,context,payload,csrfToken)},doAction:function(type,operation,context,payload,csrfToken){return api.sendRequest(type,operation,context,payload,csrfToken)}},api={specification:void 0,api:void 0,getRequestInfo:function(type,operation,context,payload,csrfToken){var endpointInfo=api.specification.endpoints[type][operation],method=endpointInfo.method.toLowerCase(),headers=headers||{},url=utils.interpolate(endpointInfo.url,context);if(payload.collector=api.specification.collector,payload.request=api.specification.collection_request,"get"==method){var params=[];for(var k in payload)if(payload.hasOwnProperty(k)){var key=encodeURIComponent(k),value=encodeURIComponent(payload[k]);params.push(key+"="+value)}url+="?"+params.join("&"),payload=void 0}return headers["Content-Type"]=api.specification.content_type,void 0!==csrfToken&&(headers["X-CSRFToken"]=csrfToken),{url:url,method:method,data:payload,headers:headers}},prepareRequest:function(args){var xhr=new XMLHttpRequest;for(var k in xhr.open(args.method,args.url),args.headers)args.headers.hasOwnProperty(k)&&xhr.setRequestHeader(k,args.headers[k]);var postString=void 0;return"get"!=args.method&&void 0!==args.data&&(postString=JSON.stringify(args.data)),function(onload){return void 0!==onload&&(xhr.onload=onload),xhr.send(postString)}},getPromise:function(type,operation,context,payload,csrfToken){var info=api.getRequestInfo(type,operation,context,payload,csrfToken),doRequest=api.prepareRequest(info);return new Promise(function(resolve,reject){doRequest(function(result){var obj=JSON.parse(result.currentTarget.response);resolve({json:obj,status:result.currentTarget.status})})})},sendRequest:function(type,operation,context,payload,csrfToken){var info=api.getRequestInfo(type,operation,context,payload,csrfToken);return api.prepareRequest(info)()}},function(collectorSpecification){return api.specification=collectorSpecification,api.api=internals.generateApi(api.specification),api});try{module.exports.DjangoInputCollection=function(specification){return DjangoInputCollection(specification)}}catch(e){}}});
